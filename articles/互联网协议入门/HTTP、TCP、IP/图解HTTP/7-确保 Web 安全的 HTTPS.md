*  在HTTP协议中有可能存在信息窃听或身份伪装等安全问题。使用HTTPS通信机制可以有效地防止这些问题。
1.  HTTP的不足:
    * 通信使用明文(不加密),内容可能会被窃听。
    * 不验证通信的身份,因此有可能遭遇伪装。
    * 无法证明报文的完整性,所以有可能已遭篡改
 ##   通信使用明文可能会被窃听
  * 由于 HTTP 本身不具备加密的功能，所以也无法做到对通信整体（使
用 HTTP 协议通信的请求和响应的内容）进行加密。即，HTTP 报文
使用明文（指未经过加密的报文）方式发送。
## TCP/IP是可能被窃听的网络
* TCP/IP 协议族的工作机制，通信内容在所有的通信线路上都有
可能遭到窥视。
* 窃听相同段上的通信并非难事。只需要收集在互联网删流动的数据包(帧)就行了。
* 抓包工具 Wireshark
## 加密处理防止被窃听
1.  通信的加密
    * 与 SSL组合使用
 2. 内容加密
## 不验证通信方的身份就可能遭遇伪装
1.  任何人都可发起请求
 2. 查明对手的证书
    *  虽然使用 HTTP 协议无法确定通信方，但如果使用 SSL 则可以。
SSL 不仅提供加密处理，而且还使用了一种被称为证书的手段，
可用于确定方。  
3. 法证明报文完整性，可能已遭篡改
    * 接受到的内容可能有误
 4. 如何防止篡改
    *    虽然有使用 HTTP 协议确定报文完整性的方法，但事实上并不便
捷、可靠。其中常用的是 MD5 和 SHA-1 等散列值校验的方法，
以及用来确认文件的数字签名方法。

# HTTP+ 加密 + 认证 + 完整性保护=HTTPS
## HTTPS是身披SSL外壳的HTTP
* HTTPS并非是应用层的一种新协议。只是HTTP通信接口部分用SSL(Secure Socker Layer) 和TLS(Transport Layer Security)协议代替而已。

![](https://raw.githubusercontent.com/1391020381/Web-Foundation/master/articles/HTTP%E3%80%81TCP%E3%80%81IP/img/SSL.png)

## 相互交换密钥的公开密钥的加密技术
* SSL采用一种叫做公开密钥加密(Public-key-cryptography)的加密处理方式。
    * 共享密钥加密的困境
        * 加密和解密同用一个密钥的方式成为共享密钥加密。也被叫做对称密钥加密。
     * 使用两把密钥的公开密钥加密
        * 公开密钥加密使用一对非对称的密钥。一把叫做私有密钥,另一把叫做公开密钥。
        * 使用公开密钥加密方式,发送密文的一方使用对方的公开密钥进行加密处理,对方收到被加密的信息后，再使用自己的私有密钥进行解密。利用这个方式,不需要发送用来解密的私有密钥,也不必担心密钥被攻击者窃听而盗走。
   ## HTTPS采用混合加密机制
   * HTTPS 采用共享密钥加密和公开密钥加密两者并用的混合加密机制。
   ## 证明公开密钥正确性的证书
   * 遗憾的是，公开密钥加密方式还是存在一些问题的。那就是无法证明
公开密钥本身就是货真价实的公开密钥。比如，正准备和某台服务器
建立公开密钥加密方式下的通信时，如何证明收到的公开密钥就是原
本预想的那台服务器发行的公开密钥。或许在公开密钥传输途中，真
正的公开密钥已经被攻击者替换掉了。
* 为了解决上述问题，可以使用由数字证书认证机构（CA，Certificate
Authority）和其相关机关颁发的公开密钥证书。
* 数字证书认证机构处于客户端与服务器双方都可信赖的第三方机构的
立场上。
### 数字证书认证机构的业务流程
1. 首先,服务器的运营人员向数字证书认证机构提出公开密钥的申请。
2. 数字证书认证机构在判明提出申请者的身份之后,会对已申请的公开密钥做数字签名,然后分配这个已签名的公开密钥,并将该公开密钥放到公钥证书后绑定在一起。
3. 服务器会将这份有数字证书认证机构颁发的公钥证书发送给客户端,以进行公开密钥方式通信。公钥证书也叫做数字证书或直接称为证书。
4. 接到证书的客户端可使用数字证书认证机构的公开密钥,对那张证书上数字签名进行验证,一旦验证通过,客户端便可明确两件事：1. 认证服务器的公开密钥的是真实有效的数字证书认证机构。2. 服务器的公开密钥是值得信赖的。

* 此处认证机关的公开密钥必须安全地转交给客户端。使用通信方式
时，如何安全转交是一件很困难的事，因此，多数浏览器开发商发布
版本时，会事先在内部植入常用认证机关的公开密钥。
 
![](https://raw.githubusercontent.com/1391020381/Web-Foundation/master/articles/HTTP%E3%80%81TCP%E3%80%81IP/img/%E8%AF%81%E6%98%8E%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E6%AD%A3%E7%A1%AE%E6%80%A7%E7%9A%84%E8%AF%81%E4%B9%A6.png)

#### 可证明组织真实性的 EV SSL 证书
### 用以确认客户端的客户端证书
### 认证机构信誉第一
### 由自认证机构颁发的证书称为自签名证书
## HTTPS 的安全通信机制

![](https://raw.githubusercontent.com/1391020381/Web-Foundation/master/articles/HTTP%E3%80%81TCP%E3%80%81IP/img/HTTPS%E7%9A%84%E9%80%9A%E4%BF%A1%E6%AD%A5%E9%AA%A4.png)

![](https://raw.githubusercontent.com/1391020381/Web-Foundation/master/articles/HTTP%E3%80%81TCP%E3%80%81IP/img/HTTPS%E7%9A%84%E9%80%9A%E4%BF%A1%E6%AD%A5%E9%AA%A4%E8%AF%A6%E8%A7%A3.png)

### HTTPS比HTTP要慢2到100倍
* SSL 的慢分两种。一种是指通信慢。另一种是指由于大量消耗CPU 及内存等资源，导致处理速度变慢。
    * 和使用 HTTP 相比，网络负载可能会变慢 2 到 100 倍。除去和TCP 连接、发送 HTTP 请求 • 响应以外，还必须进行 SSL 通信，因此整体处理通信量不可避免会增加。
    * 另一点是 SSL 必须进行加密处理。在服务器和客户端都需要进行
加密和解密的运算处理。因此从结果上讲，比起 HTTP 会更多地
消耗服务器和客户端的硬件资源，导致负载增强。
### 为什么不一直使用 HTTPS
* 因为与纯文本通信相比，加密通信会消耗更多的
CPU 及内存资源。如果每次通信都加密，会消耗相当多的资源，平
摊到一台计算机上时，能够处理的请求数量必定也会随之减少
* 想要节约购买证书的开销