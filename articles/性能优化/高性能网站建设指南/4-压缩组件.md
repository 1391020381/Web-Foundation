## 压缩是如何工作
* 用于减少文件体积的文件压缩已经在Email应用和FTP站点中使用了10年,同样的技术也可以用于
向浏览器发布压缩的Web页面。  
* Accept-Encoding: gzip,deflate
* Content-Encoding:gzip
* ## 压缩是什么
* 服务器基于文件类型选择压缩什么,但这通常受限于对其进行的配置。很多网站会压缩其HTML文档。压缩脚本和样式表也是非常值得的，实际上值得压缩的内容包括XML和JSON在内的任何响应,但这里值关注脚本和样式表，因为它们用的最普遍。
* 图片和PDGF不应该压缩,因为它们本来就已经被压缩了。试图对它们进行压缩只会浪费CPU资源,还有可能会增加文件大小。

* 压缩的成本有——服务器会花费额外的CPU周期来完成压缩,客户端要对压缩文件进行解压缩。
* 要检测收益是否大于开销,需要考虑响应的大小、连接的带宽和客户端与服务端之间的Internet距离。这些信息通常难以得到,即便得到了,也有很多其他变数需要考虑。
* `根据经验通常对大于1KB或2KB的文件进行压缩。mod_gzip_minimum_file_size指令控制着希望压缩。mod_gzip_minmum_file_size指令控制着希望压缩的文件的最小值,默认值是500B`
## 节省
* 压缩通常能将响应的数量减少将近70%。
## 配置
* 配置gzip时使用的模块取决于Apache的版本——Apache 1.3使用mod_gzip而Apache2.x使用mod_deflate。
```
mod_gzip_item_include     file    \.js$

mod_gzip_item_include    mime   ^application/x-javascript

mod_gzip_item_include      file       \.css$

mod_gzip_item_include     mime     ^text/css$


```
* mod_gzip提供了选项,可以将保存压缩过的内容自动保存在磁盘上,并在原内容发生变化是更新压缩内容。使用mod_gzip_can_negotiate和mod_gzip_update_static指令可以完成这一任务。

## Apache2.x  —— mod_deflate
* Apache 2.x中的压缩通过mod_deflate模块来完成。尽管该模块的名字是这样的,但它使用gzip来进行压缩。
```
AddOutputFilterByType  DEFLATE  text/html text/css  application/x-javascript
```
* DefalteCompre-ssionLevel  控制压缩级别的指令。

## 代理缓存